{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "NFC Logistics Payload",
  "type": "object",
  "required": [
    "transaction_id",
    "status",
    "timestamp",
    "location",
    "packing_slip",
    "bol",
    "batch_details",
    "commercial_invoice",
    "pallet_count",
    "transit_type",
    "shipper_erp",
    "receiver_erp",
    "digital_signature"
  ],
  "properties": {
    "transaction_id": {
      "type": "string",
      "description": "Unique identifier for the transaction",
      "pattern": "^TXN-[A-Z0-9]{10}$"
    },
    "status": {
      "type": "string",
      "enum": ["initiated", "in_transit", "delivered", "confirmed"],
      "description": "Current status of the shipment"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of last update"
    },
    "location": {
      "type": "object",
      "required": ["latitude", "longitude", "address"],
      "properties": {
        "latitude": {
          "type": "number",
          "minimum": -90,
          "maximum": 90
        },
        "longitude": {
          "type": "number",
          "minimum": -180,
          "maximum": 180
        },
        "address": {
          "type": "string",
          "description": "Human-readable address"
        },
        "city": {
          "type": "string"
        },
        "state": {
          "type": "string"
        },
        "zip_code": {
          "type": "string"
        }
      }
    },
    "packing_slip": {
      "type": "object",
      "required": ["slip_number", "items", "total_weight"],
      "properties": {
        "slip_number": {
          "type": "string"
        },
        "items": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["sku", "description", "quantity", "weight"],
            "properties": {
              "sku": {
                "type": "string"
              },
              "description": {
                "type": "string"
              },
              "quantity": {
                "type": "integer",
                "minimum": 1
              },
              "weight": {
                "type": "number",
                "minimum": 0
              },
              "unit": {
                "type": "string",
                "default": "lbs"
              }
            }
          }
        },
        "total_weight": {
          "type": "number",
          "minimum": 0
        },
        "weight_unit": {
          "type": "string",
          "default": "lbs"
        }
      }
    },
    "bol": {
      "type": "object",
      "required": ["number", "carrier", "origin", "destination"],
      "properties": {
        "number": {
          "type": "string",
          "description": "Bill of Lading number"
        },
        "carrier": {
          "type": "string",
          "description": "Carrier company name"
        },
        "origin": {
          "type": "string",
          "description": "Origin location"
        },
        "destination": {
          "type": "string",
          "description": "Destination location"
        },
        "pickup_date": {
          "type": "string",
          "format": "date"
        },
        "delivery_date": {
          "type": "string",
          "format": "date"
        }
      }
    },
    "batch_details": {
      "type": "object",
      "required": ["batch_id"],
      "properties": {
        "batch_id": {
          "type": "string"
        },
        "manufacture_date": {
          "type": "string",
          "format": "date"
        },
        "expiry_date": {
          "type": "string",
          "format": "date"
        },
        "lot_number": {
          "type": "string"
        },
        "serial_numbers": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "commercial_invoice": {
      "type": "object",
      "required": ["number", "total_value", "currency"],
      "properties": {
        "number": {
          "type": "string"
        },
        "total_value": {
          "type": "number",
          "minimum": 0
        },
        "currency": {
          "type": "string",
          "pattern": "^[A-Z]{3}$",
          "default": "USD"
        },
        "tax_amount": {
          "type": "number",
          "minimum": 0
        },
        "payment_terms": {
          "type": "string"
        }
      }
    },
    "pallet_count": {
      "type": "integer",
      "minimum": 0
    },
    "transit_type": {
      "type": "string",
      "enum": ["truck", "ship", "rail", "air"],
      "description": "Mode of transportation"
    },
    "shipper_erp": {
      "type": "object",
      "required": ["system", "id"],
      "properties": {
        "system": {
          "type": "string",
          "enum": ["infor_syteline", "sap", "oracle", "custom"]
        },
        "id": {
          "type": "string",
          "description": "ERP system identifier"
        },
        "order_number": {
          "type": "string"
        },
        "customer_id": {
          "type": "string"
        }
      }
    },
    "receiver_erp": {
      "type": "object",
      "required": ["system", "id"],
      "properties": {
        "system": {
          "type": "string",
          "enum": ["infor_syteline", "sap", "oracle", "custom"]
        },
        "id": {
          "type": "string",
          "description": "ERP system identifier"
        },
        "purchase_order": {
          "type": "string"
        },
        "vendor_id": {
          "type": "string"
        }
      }
    },
    "digital_signature": {
      "type": "object",
      "required": ["signature", "algorithm", "certificate"],
      "properties": {
        "signature": {
          "type": "string",
          "description": "Base64 encoded digital signature"
        },
        "algorithm": {
          "type": "string",
          "enum": ["RSA-SHA256", "ECDSA-SHA256"],
          "default": "RSA-SHA256"
        },
        "certificate": {
          "type": "string",
          "description": "Base64 encoded certificate"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    "audit_trail": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["action", "timestamp", "actor"],
        "properties": {
          "action": {
            "type": "string"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "actor": {
            "type": "string"
          },
          "location": {
            "type": "string"
          },
          "notes": {
            "type": "string"
          }
        }
      }
    }
  }
}